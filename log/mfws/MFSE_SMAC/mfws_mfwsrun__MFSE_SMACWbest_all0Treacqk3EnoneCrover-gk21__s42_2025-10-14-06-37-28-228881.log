[2025-10-14 06:37:28,229][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][color_logger.py:203] Logfile: /root/codes/multique_fidelity_spark/log/mfws/MFSE_SMAC/mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42_2025-10-14-06-37-28-228881.log
[2025-10-14 06:37:28,231][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][base.py:79] The 0-th similar task(merged_observations_20250922_103048): 0.5
[2025-10-14 06:37:28,232][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][base.py:81] Successfully filter source hpo data to 1 tasks.
[2025-10-14 06:37:28,234][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][WARNING][BO.py:291] Get objectives of space_history[0]: [ 9921.802 10590.696 12562.213 13207.576 12378.957 12945.207 10225.325
 11062.801 10166.513 10815.742 10348.783 13613.022  9160.721 12637.026
 10026.261 11003.523  8616.819  9557.746  8429.093  9230.875  8378.239
  9506.972  8523.688  9257.069  8679.158 10067.934  8623.034  9048.275
  8634.13   9125.499  8645.206  9401.522  8515.912  9292.485  8111.917
  8074.511  8153.398  8027.906  7932.982  8023.622  8426.602  7953.995
  8769.91   8745.168  8168.403  8240.892  8470.657  8071.234  8216.703
  7870.722  8112.09   8432.105  7983.465  8873.066  8610.798  9402.837
  8039.708  8226.361  8845.86  10550.555  8634.92   9066.437  9069.649
  8515.602  9562.272  9095.028  8356.265  8960.592  8457.169  9277.949
  8873.258  9480.638  8698.738  9495.616  8693.61   9982.975  8466.817
  9767.079  8353.527  9121.648  8580.295  9212.603  8611.575  9798.898
  8385.509  9153.161  8437.801  9085.262  8532.704  9156.532  7700.
 10932.944  8663.987  9098.07  11037.824 10098.673  8835.853  8400.606
  9382.858  8520.306  9814.129  9036.935 10203.067  9645.262  8435.346
  8431.402  9593.136 10314.887  8163.31  10070.092 11121.272 10382.009
 10038.415 11051.085 11723.766 11103.523]
[2025-10-14 06:37:28,621][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:305] [Compression] Keep-by-expert parameters: ['spark.default.parallelism', 'spark.driver.cores', 'spark.driver.memory', 'spark.executor.cores', 'spark.executor.instances', 'spark.executor.memory', 'spark.executor.memoryOverhead', 'spark.locality.wait', 'spark.network.timeout', 'spark.sql.autoBroadcastJoinThreshold', 'spark.sql.broadcastTimeout', 'spark.sql.shuffle.partitions', 'spark.sql.sources.parallelPartitionDiscovery.parallelism', 'spark.task.cpus', 'spark.driver.maxResultSize', 'spark.scheduler.minRegisteredResourcesRatio']
[2025-10-14 06:37:28,621][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:417] Use algorithm [rover-g] to reset search space, only use indices: [3, 4, 5, 6, 13, 15, 16, 17, 23, 24, 25, 31, 35, 36, 42, 58, 70, 71, 73, 74, 80]
[2025-10-14 06:37:28,630][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:433] Currently fixed indices: [0, 1, 2, 7, 8, 9, 10, 11, 12, 14, 18, 19, 20, 21, 22, 26, 27, 28, 29, 30, 32, 33, 34, 37, 38, 39, 40, 41, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 72, 75, 76, 77, 78, 79, 81, 82]
[2025-10-14 06:37:28,633][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:348] Begin to make range compression...
[2025-10-14 06:37:28,634][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:377] Range compressed for [spark.default.parallelism]: [148, 980], default=600
[2025-10-14 06:37:28,635][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:377] Range compressed for [spark.driver.cores]: [1, 14], default=1
[2025-10-14 06:37:28,636][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:377] Range compressed for [spark.driver.maxResultSize]: [2048, 2068], default=2048
[2025-10-14 06:37:28,637][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:377] Range compressed for [spark.driver.memory]: [57, 116], default=86
[2025-10-14 06:37:28,638][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:377] Range compressed for [spark.executor.cores]: [14, 32], default=16
[2025-10-14 06:37:28,639][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:377] Range compressed for [spark.executor.instances]: [7, 19], default=12
[2025-10-14 06:37:28,640][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:377] Range compressed for [spark.executor.memory]: [9, 46], default=27
[2025-10-14 06:37:28,641][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:377] Range compressed for [spark.executor.memoryOverhead]: [824, 12734], default=1024
[2025-10-14 06:37:28,642][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:377] Range compressed for [spark.io.compression.snappy.blockSize]: [64, 69], default=66
[2025-10-14 06:37:28,643][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:377] Range compressed for [spark.io.compression.zstd.bufferSize]: [1, 96], default=32
[2025-10-14 06:37:28,644][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:377] Range compressed for [spark.io.compression.zstd.level]: [1, 8], default=1
[2025-10-14 06:37:28,645][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:377] Range compressed for [spark.locality.wait]: [0, 2], default=0
[2025-10-14 06:37:28,646][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:377] Range compressed for [spark.memory.storageFraction]: [0.1, 0.8], default=0.5
[2025-10-14 06:37:28,647][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:377] Range compressed for [spark.network.timeout]: [536, 5592], default=600
[2025-10-14 06:37:28,648][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:377] Range compressed for [spark.scheduler.minRegisteredResourcesRatio]: [0.8, 1.0], default=0.8
[2025-10-14 06:37:28,649][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:377] Range compressed for [spark.shuffle.spill.diskWriteBufferSize]: [1048576, 104857600], default=1048576
[2025-10-14 06:37:28,650][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:377] Range compressed for [spark.sql.autoBroadcastJoinThreshold]: [100, 411], default=100
[2025-10-14 06:37:28,651][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:377] Range compressed for [spark.sql.broadcastTimeout]: [1320, 25237], default=13278
[2025-10-14 06:37:28,652][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:377] Range compressed for [spark.sql.shuffle.partitions]: [946, 1171], default=1058
[2025-10-14 06:37:28,653][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:377] Range compressed for [spark.sql.sources.parallelPartitionDiscovery.parallelism]: [63, 129], default=96
[2025-10-14 06:37:28,654][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:377] Range compressed for [spark.task.cpus]: [1, 8], default=1
[2025-10-14 06:37:28,656][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:326] ConfigSpace after whole compression (dimension + range): Configuration space object:
  Hyperparameters:
    spark.default.parallelism, Type: UniformInteger, Range: [148, 980], Default: 600
    spark.driver.cores, Type: UniformInteger, Range: [1, 14], Default: 1
    spark.driver.maxResultSize, Type: UniformInteger, Range: [2048, 2068], Default: 2048
    spark.driver.memory, Type: UniformInteger, Range: [57, 116], Default: 86
    spark.executor.cores, Type: UniformInteger, Range: [14, 32], Default: 16
    spark.executor.instances, Type: UniformInteger, Range: [7, 19], Default: 12
    spark.executor.memory, Type: UniformInteger, Range: [9, 46], Default: 27
    spark.executor.memoryOverhead, Type: UniformInteger, Range: [824, 12734], Default: 1024
    spark.io.compression.snappy.blockSize, Type: UniformInteger, Range: [64, 69], Default: 66
    spark.io.compression.zstd.bufferSize, Type: UniformInteger, Range: [1, 96], Default: 32
    spark.io.compression.zstd.level, Type: UniformInteger, Range: [1, 8], Default: 1
    spark.locality.wait, Type: UniformInteger, Range: [0, 2], Default: 0
    spark.memory.storageFraction, Type: UniformFloat, Range: [0.1, 0.8], Default: 0.5
    spark.network.timeout, Type: UniformInteger, Range: [536, 5592], Default: 600
    spark.scheduler.minRegisteredResourcesRatio, Type: UniformFloat, Range: [0.8, 1.0], Default: 0.8
    spark.shuffle.spill.diskWriteBufferSize, Type: UniformInteger, Range: [1048576, 104857600], Default: 1048576
    spark.sql.autoBroadcastJoinThreshold, Type: UniformInteger, Range: [100, 411], Default: 100
    spark.sql.broadcastTimeout, Type: UniformInteger, Range: [1320, 25237], Default: 13278
    spark.sql.shuffle.partitions, Type: UniformInteger, Range: [946, 1171], Default: 1058
    spark.sql.sources.parallelPartitionDiscovery.parallelism, Type: UniformInteger, Range: [63, 129], Default: 96
    spark.task.cpus, Type: UniformInteger, Range: [1, 8], Default: 1
 !!!
[2025-10-14 06:37:28,656][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BO.py:329] Compressed configuration space: ['spark.default.parallelism', 'spark.driver.cores', 'spark.driver.maxResultSize', 'spark.driver.memory', 'spark.executor.cores', 'spark.executor.instances', 'spark.executor.memory', 'spark.executor.memoryOverhead', 'spark.io.compression.snappy.blockSize', 'spark.io.compression.zstd.bufferSize', 'spark.io.compression.zstd.level', 'spark.locality.wait', 'spark.memory.storageFraction', 'spark.network.timeout', 'spark.scheduler.minRegisteredResourcesRatio', 'spark.shuffle.spill.diskWriteBufferSize', 'spark.sql.autoBroadcastJoinThreshold', 'spark.sql.broadcastTimeout', 'spark.sql.shuffle.partitions', 'spark.sql.sources.parallelPartitionDiscovery.parallelism', 'spark.task.cpus']
[2025-10-14 06:37:28,780][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][WARNING][history.py:242] Duplicate configuration detected!
[2025-10-14 06:37:28,781][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][WARNING][history.py:242] Duplicate configuration detected!
[2025-10-14 06:37:28,782][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][WARNING][history.py:242] Duplicate configuration detected!
[2025-10-14 06:37:28,789][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][WARNING][history.py:242] Duplicate configuration detected!
[2025-10-14 06:37:28,799][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][WARNING][history.py:242] Duplicate configuration detected!
[2025-10-14 06:37:28,800][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][WARNING][history.py:242] Duplicate configuration detected!
[2025-10-14 06:37:28,800][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][WARNING][history.py:242] Duplicate configuration detected!
[2025-10-14 06:37:28,801][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][WARNING][history.py:242] Duplicate configuration detected!
[2025-10-14 06:37:28,801][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][history.py:253] 116 observations updated in history.
[2025-10-14 06:37:28,802][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][base.py:143] Start to train base surrogates.
[2025-10-14 06:37:28,804][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][WARNING][base.py:64] [Build Surrogate] Use probabilistic random forest based on scikit-learn. For better performance, please install pyrfr: https://open-box.readthedocs.io/en/latest/installation/install_pyrfr.html
[2025-10-14 06:37:29,195][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][base.py:163] Building base surrogates took 0.393s.
[2025-10-14 06:37:29,323][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][WARNING][history.py:242] Duplicate configuration detected!
[2025-10-14 06:37:29,324][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][WARNING][history.py:242] Duplicate configuration detected!
[2025-10-14 06:37:29,325][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][WARNING][history.py:242] Duplicate configuration detected!
[2025-10-14 06:37:29,332][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][WARNING][history.py:242] Duplicate configuration detected!
[2025-10-14 06:37:29,342][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][WARNING][history.py:242] Duplicate configuration detected!
[2025-10-14 06:37:29,343][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][WARNING][history.py:242] Duplicate configuration detected!
[2025-10-14 06:37:29,343][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][WARNING][history.py:242] Duplicate configuration detected!
[2025-10-14 06:37:29,344][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][WARNING][history.py:242] Duplicate configuration detected!
[2025-10-14 06:37:29,344][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][history.py:253] 116 observations updated in history.
[2025-10-14 06:37:29,345][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BOHB.py:55] Fidelity levels of MFSE_SMAC: [1, 4, 16, 64]
[2025-10-14 06:37:29,345][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][BOHB.py:68] Run 4 brackets with number of configurations [16, 16, 16, 16] and resources [1, 1, 1, 1]. s_max = [3]
[2025-10-14 06:37:29,345][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][utils.py:69] [opt: MFSE_SMAC] [warm_start_strategy: best_all] [transfer_strategy: reacq] [safe_flag: False] [backup_flag: False] [tasks: run] [seed: 42] [rand_prob: 0.1]
[2025-10-14 06:37:29,345][mfws_mfwsrun__MFSE_SMACWbest_all0Treacqk3EnoneCrover-gk21__s42][INFO][utils.py:73] warm start args: best_all: {"init_num": 0, "topk": 14, "inner_surrogate_model": "prf"}
